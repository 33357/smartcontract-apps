# 空投常用签名方案

## 备注

时间：2025 年 9 月 21 日

作者：[33357](https://github.com/33357)

## 正文

目前常用的空投签名方案有 Merkle List 和 EIP712 两种，这里我会分析两者的区别。

### Merkle List

使用 Merkle List 需要构建默克尔树的数据结构，构建者需要先确定空投地址名单和数量，通过 keccak256(空投地址，空投数量) 生成每个空投的 hash。

然后按照将 hashFather = keccak256(hashLeft,hashRight) 的规则从下往上构建成一颗默克尔树，将最终的 MerkleRoot 写在空投合约里。

服务器给用户分发 {空投地址，空投数量, MerkleProof} 的数据，用户就可以向合约提交验证。

合约验证时，只需要将 keccak256(空投地址，空投数量) 生产的 hash 和 MerkleProof 的 hashList 重新计算一遍，是否和 MerkleRoot 一致就可以确定真伪。

方案的特点：

1、只有修改 MerkleRoot 才能修改已经确定空投的地址和数量，不能随意增发。

2、用户证明数据的大小和默克尔树的高度成正比，和空投地址总量相关。

3、一般会公布默克尔树，可以查看每个地址的空投数量并算出空投总量。

### EIP712

使用 EIP712 需要保存一个 signer 私钥，构建者需要使用私钥对每个地址和数量进行 EIP712 签名生成 signature。

合约需要保存 signer 的地址。

服务器给用户分发 {空投地址，空投数量, signature} 的数据，用户就可以向合约提交验证。

合约验证时，使用 ECDSA 解析出签名者，是否和 signer 一致就可以确定真伪。

方案的特点：

1、singer 可以随意签名增发空投，比较灵活。

2、用户证明数据的大小固定，和空投地址总量无关。

3、通常只会给用户看自己的空投数量，不能确定每个地址的空投数量和空投总量。

### 总结

Merkle List 空投透明度高、不能随意修改，是目前使用最多的空投签名方式。不过以上两种签名都只能向已知地址空投，不够灵活。